<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            font-family: 'Open Sans', sans-serif;
            line-height: 24px;
        }
    </style>
</head>

<body style="margin: 0; padding: 0;">
<table style="color: #fff; background: #875FFC; padding: 31px; font-size: 16px; font-weight: 600; margin: 0;">
    <tr>
        <td>
            <img style="color: #ff0000; padding-right: 15px; display: inline-block;"
                    alt="Logo"
                    width="20"
                    height="24"
                    src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFdSURBVHgBrVQLccMwDHV2AxAGG4OGQVsE2xAEQiEEQiH0iqBj4A5Bx8BjEAia1JOvyoucpp93p4scy0+WLCmEmSCiOjwDTPTOElkSSxseBZNslCxD9I9bCORGW3sb/bejIWT9NkVUs3QsvTm0dZxFIO5GxHIbIOqn8qX2CdLQ5s0IRB2+qOTMc+BElMJUTni9BIfRsZE0HLKBJVxBPndAFEvO1bFPyN+FCSOBo5YuuRObBglfxykPtcqxqqp1Dks+vN6z/sP6ydgN8BLK+FMyKeIka8mV6sU2nCLMaIz+ec14DuGe5ZvlyPKlXw+/LGvvUZbmQUY9q/u9PYMGSIglcy4RGrfdgbxeRkLzv6Fhe2VE72Z683OnpOL1w6D23P4m6CY7mlZqIIXdwSFJA/a3O9JCwSNRYUKTP+ZiKUIvd6IvTPg97PlEM8I5GV1IN+FWOMTuvLyHWAasX3eAf8SBG7h4AQZrAAAAAElFTkSuQmCC">
        </td>
        <td style="margin-left: 8px; font-size: 14px; font-weight: 700; width: 100%">
            Backend Performance Report
        </td>
        <td>CARRIER</td>
    </tr>
</table>

<div style="margin: 0; padding: 0;">
    {% if t_params.debug_info %}
    <!-- DEBUG SECTION - Show at the top -->
    <div style="margin: 24px 12px 20px 12px; padding: 12px; background: #FFF3CD; border: 1px solid #FFC107; border-radius: 4px;">
        <p style="margin: 0 0 8px 0; font-weight: 700; color: #856404; font-size: 14px;">üîç DEBUG INFO</p>
        <p style="margin: 0; font-size: 12px; color: #856404; line-height: 18px;">
            <strong>sla_has_every:</strong> {{ t_params.debug_info.sla_has_every }}<br>
            <strong>comparison_metric:</strong> {{ t_params.debug_info.comparison_metric }}<br>
            
            <strong>INPUT thresholds (parameter passed to method):</strong><br>
            {% if t_params.debug_info.input_thresholds %}
                {% for th in t_params.debug_info.input_thresholds %}
                    &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ {{ th }}<br>
                {% endfor %}
            {% else %}
                &nbsp;&nbsp;&nbsp;&nbsp;none<br>
            {% endif %}
            
            <strong>API thresholds (fetched from Galloper for baseline):</strong><br>
            {% if t_params.debug_info.api_thresholds %}
                {% for th in t_params.debug_info.api_thresholds %}
                    &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ {{ th }}<br>
                {% endfor %}
            {% else %}
                &nbsp;&nbsp;&nbsp;&nbsp;none<br>
            {% endif %}
            
            <strong>ALL thresholds (before target filter in main loop):</strong><br>
            {% if t_params.debug_info.all_thresholds %}
                {% for th in t_params.debug_info.all_thresholds %}
                    &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ {{ th }}<br>
                {% endfor %}
            {% else %}
                &nbsp;&nbsp;&nbsp;&nbsp;none<br>
            {% endif %}
            
            <strong>RT thresholds only (after target filter):</strong><br>
            {% if t_params.debug_info.rt_thresholds %}
                {% for th in t_params.debug_info.rt_thresholds %}
                    &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ {{ th }}<br>
                {% endfor %}
            {% else %}
                &nbsp;&nbsp;&nbsp;&nbsp;none<br>
            {% endif %}
            
            {% if t_params.debug_info.threshold_lookups %}
            <strong>Threshold lookup samples (first 3 requests):</strong><br>
                {% for lookup in t_params.debug_info.threshold_lookups %}
                    &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¢ {{ lookup }}<br>
                {% endfor %}
            {% endif %}
        </p>
    </div>
    {% endif %}
    
    <p style="margin: 24px 0 20px 0; padding: 0 12px; font-weight: 700; color: #525F7F;">Execution Summary</p>
    <table style="border-spacing: 10px;">
        <tr>
            <td style="border-radius: 4px; padding: 4px 12px; background: {{ t_params.color }};">
                <div style="color: #fff; font-size: 16px; font-weight: 600;">
                    <span>Status:</span>
                    <span>{{ t_params.status }}</span>
                </div>
            </td>
            {% if t_params.threshold_status != 'N/A' %}
            <td style="background: #F6F9FC; padding: 4px 12px; border-radius: 4px;">
                <div style="color: #32325D; font-size: 16px; font-weight: 400;">
                    <span style="margin-right: 10px">SLA failed rate: {{ t_params.missed_threshold_rate }}</span>
                    {% if t_params.threshold_status == 'success' %}
                    <span style="color: #139A41; font-size: 16px; font-weight: bold;">‚úì</span>
                    {% endif %}
                    {% if t_params.threshold_status == 'warning' %}
                    <span style="color: #FFA500; font-size: 16px; font-weight: bold;">‚ö†</span>
                    {% endif %}
                    {% if t_params.threshold_status == 'failed' %}
                    <span style="color: #F32626; font-size: 16px; font-weight: bold;">‚úó</span>
                    {% endif %}
                </div>
            </td>
            {% endif %}

            {% if t_params.baseline_status != 'N/A' and t_params.baseline_status != 'missing' %}
            <td style="background: #F6F9FC; padding: 4px 12px; border-radius: 4px;">
                <div style="color: #32325D; font-size: 16px; font-weight: 400;">
                    <span style="margin-right: 10px">Baseline failed rate: {{ t_params.performance_degradation_rate }}</span>
                    {% if t_params.baseline_status == 'success' %}
                    <span style="color: #139A41; font-size: 16px; font-weight: bold;">‚úì</span>
                    {% endif %}
                    {% if t_params.baseline_status == 'warning' %}
                    <span style="color: #FFA500; font-size: 16px; font-weight: bold;">‚ö†</span>
                    {% endif %}
                    {% if t_params.baseline_status == 'failed' %}
                    <span style="color: #F32626; font-size: 16px; font-weight: bold;">‚úó</span>
                    {% endif %}
                </div>
            </td>
            {% endif %}
        </tr>
        {% if t_params.current_report_url %}
        <tr>
            <td colspan="3" style="padding: 8px 12px;">
                <a href="{{ t_params.current_report_url }}" style="color: #875FFC; text-decoration: none; font-size: 14px;">View current test report ‚Üí</a>
            </td>
        </tr>
        {% endif %}
        {% if t_params.baseline_status != 'N/A' and t_params.baseline_status != 'missing' and t_params.baseline_report_url %}
        <tr>
            <td colspan="3" style="padding: 8px 12px;">
                <a href="{{ t_params.baseline_report_url }}" style="color: #875FFC; text-decoration: none; font-size: 14px;">View baseline test report ‚Üí</a>
            </td>
        </tr>
        {% endif %}
    </table>
    {% if t_params.status == 'failed' %}
    <div style="margin-top: 24px;">
        <p style="margin: 24px 0 0px 0; padding: 0 12px; font-weight: 700; color: #525F7F;">Failed reasons:</p>
        <ul style="padding-left: 25px;">
        {% for reason in t_params.reasons_to_fail_report %}
            <li style="list-style: none">
                <span style="color: #F32626; font-size: 14px; font-weight: bold; margin-right: 5px;">‚úó</span>{{ reason|format_failed_reason }}
            </li>
        {% endfor %}
        </ul>
    </div>
    {% endif %}

    <div style="margin-top: 24px;">
        <table style="width: 100%;">
            <tbody>
            <tr>
                <td style="border-bottom: solid 1px #EAEDEF; color: #32325D; padding: 4px 12px; font-weight: 600; width: 25%;">Test name:</td>
                <td style="border-bottom: solid 1px #EAEDEF; color: #525F7F; padding: 4px 12px; width: 25%;">{{ t_params.simulation }}</td>
            </tr>
            <tr>
                <td style="border-bottom: solid 1px #EAEDEF; color: #32325D; padding: 4px 12px; font-weight: 600; width: 25%;">VUsers:</td>
                <td style="border-bottom: solid 1px #EAEDEF; color: #525F7F; padding: 4px 12px; width: 25%;">{{ t_params.users }}</td>
            </tr>
            <tr>
                <td style="border-bottom: solid 1px #EAEDEF; color: #32325D; padding: 4px 12px; font-weight: 600; width: 25%;">Duration, sec:</td>
                <td style="border-bottom: solid 1px #EAEDEF; color: #525F7F; padding: 4px 12px; width: 25%;">{{ t_params.duration }}</td>
            </tr>
            <tr>
                <td style="border-bottom: solid 1px #EAEDEF; color: #32325D; padding: 4px 12px; font-weight: 600; width: 25%;">Started, CET:</td>
                <td style="border-bottom: solid 1px #EAEDEF; color: #525F7F; padding: 4px 12px; width: 25%;">{{ t_params.start }}</td>
            </tr>
            <tr>
                <td style="border-bottom: solid 1px #EAEDEF; color: #32325D; padding: 4px 12px; font-weight: 600; width: 25%;">Ended, CET:</td>
                <td style="border-bottom: solid 1px #EAEDEF; color: #525F7F; padding: 4px 12px; width: 25%;">{{ t_params.end }}</td>
            </tr>
            <tr>
                <td style="border-bottom: solid 1px #EAEDEF; color: #32325D; padding: 4px 12px; font-weight: 600; width: 25%;">Environment:</td>
                <td style="border-bottom: solid 1px #EAEDEF; color: #525F7F; padding: 4px 12px; width: 25%;">{{ t_params.env }}</td>
            </tr>
            <tr>
                <td style="border-bottom: solid 1px #EAEDEF; color: #32325D; padding: 4px 12px; font-weight: 600; width: 25%;">Test type:</td>
                <td style="border-bottom: solid 1px #EAEDEF; color: #525F7F; padding: 4px 12px; width: 25%;">{{ t_params.test_type }}</td>
            </tr>
            </tbody>
        </table>
    </div>

    {% if general_metrics.show_baseline_column %}
    <p style="margin: 24px 0 8px 0; padding: 0 12px; font-weight: 700; color: #525F7F;">General metrics vs Baseline</p>
    <table style=" width: 100%;">
        <thead>
        <tr>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: left;">Metric</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Current value</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Baseline value (Baseline with deviation)</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Baseline diff</th>
        </tr>
        </thead>
        <tbody>
        {% if t_params.summary_tp_check %}
        <tr>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: left; border-bottom: solid 1px #EAEDEF;">Throughput, req/sec</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ general_metrics.current_tp|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #757F99; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ general_metrics.baseline_tp_original|format_number }} ({{ general_metrics.baseline_tp_value|format_number }})</td>
            <td style="padding: 8px 12px; font-size: 14px; color: {{ general_metrics.baseline_tp_color }}; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ general_metrics.baseline_tp|format_number }}</td>
        </tr>
        {% endif %}
        {% if t_params.summary_er_check %}
        <tr>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: left; border-bottom: solid 1px #EAEDEF;">Error rate, %</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ general_metrics.current_er|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #757F99; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ general_metrics.baseline_er_original|format_number }} ({{ general_metrics.baseline_er_value|format_number }})</td>
            <td style="padding: 8px 12px; font-size: 14px; color: {{ general_metrics.baseline_er_color }}; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ general_metrics.baseline_er|format_number }}</td>
        </tr>
        {% endif %}
        {% if t_params.summary_rt_check %}
        <tr>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: left; border-bottom: solid 1px #EAEDEF;">Response time ({{ general_metrics.comparison_metric }}), sec</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ general_metrics.current_rt|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #757F99; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ general_metrics.baseline_rt_original|format_number }} ({{ general_metrics.baseline_rt_value|format_number }})</td>
            <td style="padding: 8px 12px; font-size: 14px; color: {{ general_metrics.baseline_rt_color }}; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ general_metrics.baseline_rt|format_number }}</td>
        </tr>
        {% endif %}
        </tbody>
    </table>
    {% endif %}

    {% if general_metrics.show_threshold_column %}
    <p style="margin: 24px 0 8px 0; padding: 0 12px; font-weight: 700; color: #525F7F;">General metrics vs SLA</p>
    <table style=" width: 100%;">
        <thead>
        <tr>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: left;">Metric</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Current value</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">SLA value (SLA with deviation)</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">SLA diff</th>
        </tr>
        </thead>
        <tbody>
        {% if general_metrics.threshold_tp != 'N/A' and t_params.summary_tp_check %}
        <tr>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: left; border-bottom: solid 1px #EAEDEF;">Throughput, req/sec</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ general_metrics.current_tp|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #757F99; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ general_metrics.threshold_tp_original|format_number }} ({{ general_metrics.threshold_tp_value|format_number }})</td>
            <td style="padding: 8px 12px; font-size: 14px; color: {{ general_metrics.threshold_tp_color }}; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ general_metrics.threshold_tp|format_number }}</td>
        </tr>
        {% endif %}
        {% if general_metrics.threshold_er != 'N/A' and t_params.summary_er_check %}
        <tr>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: left; border-bottom: solid 1px #EAEDEF;">Error rate, %</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ general_metrics.current_er|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #757F99; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ general_metrics.threshold_er_original|format_number }} ({{ general_metrics.threshold_er_value|format_number }})</td>
            <td style="padding: 8px 12px; font-size: 14px; color: {{ general_metrics.threshold_er_color }}; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ general_metrics.threshold_er|format_number }}</td>
        </tr>
        {% endif %}
        {% if general_metrics.threshold_rt != 'N/A' and t_params.summary_rt_check %}
        <tr>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: left; border-bottom: solid 1px #EAEDEF;">Response time ({{ general_metrics.comparison_metric }}), sec</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ general_metrics.current_rt|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #757F99; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ general_metrics.threshold_rt_original|format_number }} ({{ general_metrics.threshold_rt_value|format_number }})</td>
            <td style="padding: 8px 12px; font-size: 14px; color: {{ general_metrics.threshold_rt_color }}; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ general_metrics.threshold_rt|format_number }}</td>
        </tr>
        {% endif %}
        </tbody>
    </table>
    {% endif %}

    <p style="margin: 24px 0 8px 0; padding: 0 12px; font-weight: 700; color: #525F7F;">Success Rate</p>
    <div>
        <div align="center">
            <img src="cid:success_rate"/>
        </div>
    </div>

    <p style="margin: 24px 0 8px 0; padding: 0 12px; font-weight: 700; color: #525F7F;">RPS/TPS Rate</p>
    <div>
        <div align="center">
            <img src="cid:throughput"/>
        </div>
    </div>

    <p style="margin: 24px 0 8px 0; padding: 0 12px; font-weight: 700; color: #525F7F;">Response Time ({{ general_metrics.comparison_metric }})</p>
    <div>
        <div align="center">
            <img src="cid:response_time"/>
        </div>
    </div>

    <p style="margin: 24px 0 8px 0; padding: 0 12px; font-weight: 700; color: #525F7F;">Request metrics</p>
    <table style=" width: 100%;">
        <thead>
        <tr>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: left;">Request name</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Current ({{ general_metrics.comparison_metric }}), sec</th>
            {% if baseline_and_thresholds.show_baseline_column %}
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Baseline value (Baseline with deviation), sec</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Baseline diff, sec</th>
            {% endif %}
            {% if baseline_and_thresholds.show_threshold_column %}
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Threshold value (Threshold with deviation), sec{% if baseline_and_thresholds.has_missing_sla %} <span style="color: #FFA400; font-size: 11px;">‚ö†Ô∏è</span><br><span style="font-size: 10px; font-weight: 400; color: #8492A6;">(Configure for {{ general_metrics.comparison_metric }})</span>{% endif %}</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Threshold diff, sec{% if baseline_and_thresholds.has_missing_sla %} <span style="color: #FFA400; font-size: 11px;">‚ö†Ô∏è</span><br><span style="font-size: 10px; font-weight: 400; color: #8492A6;">(Configure for {{ general_metrics.comparison_metric }})</span>{% endif %}</th>
            {% endif %}
            {% if baseline_and_thresholds.show_representation_column %}
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: left;">Representation</th>
            {% endif %}
        </tr>
        </thead>
        <tbody>
        {% set prev_category = namespace(value='') %}
        {% for baseline_result in baseline_and_thresholds.requests %}
        {% if baseline_result.category != prev_category.value %}
            {% if baseline_result.category == 'transaction' %}
        <tr>
            <td colspan="10" style="color: #8492A6; padding: 4px 12px; line-height: 14px; font-size: 11px; font-weight: 500; background: #FAFBFC; border-bottom: solid 1px #EAEDEF; text-align: left;">Transactions</td>
        </tr>
            {% elif baseline_result.category == 'request' %}
        <tr>
            <td colspan="10" style="color: #8492A6; padding: 4px 12px; line-height: 14px; font-size: 11px; font-weight: 500; background: #FAFBFC; border-bottom: solid 1px #EAEDEF; text-align: left;">Requests</td>
        </tr>
            {% endif %}
            {% set prev_category.value = baseline_result.category %}
        {% endif %}
        <tr>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: left; border-bottom: solid 1px #EAEDEF;">{{ baseline_result.request_name }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ baseline_result.response_time|format_number }}</td>
            {% if baseline_and_thresholds.show_baseline_column %}
            <td style="padding: 8px 12px; {% if baseline_result.baseline_value in ['Baseline disabled', 'N/A'] %}font-size: 12px; color: #8492A6; font-style: italic;{% else %}font-size: 14px; color: #757F99;{% endif %} text-align: right; border-bottom: solid 1px #EAEDEF;">{% if baseline_result.baseline_value in ['Baseline disabled', 'N/A'] %}{{ baseline_result.baseline_value }}{% else %}{{ baseline_result.baseline_original_value|format_number }} ({{ baseline_result.baseline_value|format_number }}){% endif %}</td>
            <td style="padding: 8px 12px; font-size: 14px; {% if baseline_result.baseline == '-' %}color: #8492A6;{% else %}color: {{ baseline_result.baseline_color }};{% endif %} text-align: right; border-bottom: solid 1px #EAEDEF;">{% if baseline_result.baseline == '-' %}{{ baseline_result.baseline }}{% else %}{{ baseline_result.baseline|format_number }}{% endif %}</td>
            {% endif %}
            {% if baseline_and_thresholds.show_threshold_column %}
            <td style="padding: 8px 12px; {% if baseline_result.threshold_value in ['Set SLA', 'SLA disabled'] %}font-size: 12px; color: #8492A6; font-style: italic;{% else %}font-size: 14px; color: #757F99;{% endif %} text-align: right; border-bottom: solid 1px #EAEDEF;">{% if baseline_result.threshold_value in ['Set SLA', 'SLA disabled'] %}{{ baseline_result.threshold_value }}{% else %}{{ baseline_result.threshold_original_value|format_number }} ({{ baseline_result.threshold_value|format_number }}){% endif %}</td>
            <td style="padding: 8px 12px; font-size: 14px; {% if baseline_result.threshold == '-' %}color: #8492A6;{% else %}color: {{ baseline_result.threshold_color }};{% endif %} text-align: right; border-bottom: solid 1px #EAEDEF;">{% if baseline_result.threshold in ['-', 'Set SLA', 'SLA disabled'] %}{{ baseline_result.threshold }}{% else %}{{ baseline_result.threshold|format_number }}{% endif %}</td>
            {% endif %}
            {% if baseline_and_thresholds.show_representation_column %}
            <td style="padding: 8px 12px; text-align: left; border-bottom: solid 1px #EAEDEF;"><span style="background: {{ baseline_result.line_color}}; width: 25px; height: 25px; display: inline-block;">&nbsp;</span></td>
            {% endif %}
        </tr>
        {% endfor %}
        </tbody>
    </table>

    <p style="margin: 24px 0 8px 0; padding: 0 12px; font-weight: 700; color: #525F7F;">Comparison vs latest builds</p>
    <table style=" width: 100%;">
        <thead>
        <tr>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: left;">Date, CET</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Ttl req, count</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Diff, count</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Thrghpt, req/sec</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Diff, req/sec</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Err. rate, %</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Diff, %</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">{{ general_metrics.comparison_metric }}, sec</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Diff, sec</th>
        </tr>
        </thead>
        <tbody>
        {% for comparison_result in comparison %}
        <tr>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: left; border-bottom: solid 1px #EAEDEF;">
                {% if comparison_result.report_url %}
                <a href="{{ comparison_result.report_url }}" style="color: #875FFC; text-decoration: none;">{{ comparison_result.date }}</a>
                {% else %}
                {{ comparison_result.date }}
                {% endif %}
            </td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ comparison_result.total|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ comparison_result.total_diff|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ comparison_result.throughput|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ comparison_result.throughput_diff|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ comparison_result.error_rate|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ comparison_result.error_rate_diff|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ comparison_result.response_time|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ comparison_result.response_time_diff|format_number }}</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>

    <p style="margin: 24px 0 8px 0; padding: 0 12px; font-weight: 700; color: #525F7F;">Results summary table</p>
    <table style=" width: 100%;">
        <thead>
        <tr>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: left;">Request name</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Ttl req, count</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Thrpt, req/sec</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Error, count</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Min, sec</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Max, sec</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">Pct90, sec</th>
            <th style="color: #757F99; padding: 8px 12px; line-height: 16px; font-size: 12px; font-weight: 600; background: #F9FAFF;  border-bottom: solid 1px #EAEDEF; border-top: solid 1px #EAEDEF; text-align: right;">{{ comparison_metric|capitalize }}, sec</th>
        </tr>
        </thead>
        <tbody>
        {% set prev_category_summary = namespace(value='') %}
        {% for summary_result in summary %}
        {% if summary_result.category != prev_category_summary.value %}
            {% if summary_result.category == 'transaction' %}
        <tr>
            <td colspan="10" style="color: #8492A6; padding: 4px 12px; line-height: 14px; font-size: 11px; font-weight: 500; background: #FAFBFC; border-bottom: solid 1px #EAEDEF; text-align: left;">Transactions</td>
        </tr>
            {% elif summary_result.category == 'request' %}
        <tr>
            <td colspan="10" style="color: #8492A6; padding: 4px 12px; line-height: 14px; font-size: 11px; font-weight: 500; background: #FAFBFC; border-bottom: solid 1px #EAEDEF; text-align: left;">Requests</td>
        </tr>
            {% endif %}
            {% set prev_category_summary.value = summary_result.category %}
        {% endif %}
        <tr>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: left; border-bottom: solid 1px #EAEDEF;">{{ summary_result.request_name }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ summary_result.total|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ summary_result.throughput|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ summary_result.ko|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ ((summary_result.min / 1000) | round(2))|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ ((summary_result.max / 1000) | round(2))|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ ((summary_result.pct90 / 1000) | round(2))|format_number }}</td>
            <td style="padding: 8px 12px; font-size: 14px; color: #32325D; text-align: right; border-bottom: solid 1px #EAEDEF;">{{ ((summary_result[comparison_metric] / 1000) | round(2))|format_number }}</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>

    <!-- YELLOW WARNINGS (Deviation) - display first -->
    {% if t_params.baseline_deviation_warning %}
    <div style="margin: 24px 12px 12px; padding: 12px; background-color: #FFF9E6; border-left: 4px solid #FFC107; border-radius: 4px;">
        <p style="margin: 0; color: #8B6F00; font-size: 12px;">
            <span style="font-weight: 700;">‚ÑπÔ∏è Note:</span> Baseline has configured acceptable deviation. Validation results take into account the allowed deviation range when comparing actual values against baseline.
        </p>
    </div>
    {% endif %}

    {% if t_params.sla_deviation_warning %}
    <div style="margin: 12px 12px; padding: 12px; background-color: #FFF9E6; border-left: 4px solid #FFC107; border-radius: 4px;">
        <p style="margin: 0; color: #8B6F00; font-size: 12px;">
            <span style="font-weight: 700;">‚ÑπÔ∏è Note:</span> SLA has configured acceptable deviation. Validation results take into account the allowed deviation range when comparing actual values against SLA thresholds.
        </p>
    </div>
    {% endif %}

    <!-- BLUE WARNINGS (Configuration) - display second -->
    {% if t_params.baseline_metric_warning %}
    <div style="margin: 12px 12px; padding: 12px; background-color: #E3F2FD; border-left: 4px solid #42A5F5; border-radius: 4px;">
        <p style="margin: 0; color: #0D47A1; font-size: 12px;">
            <span style="font-weight: 700;">‚ÑπÔ∏è Note:</span> {{ t_params.baseline_metric_warning }}
        </p>
    </div>
    {% endif %}

    {% if t_params.baseline_status == 'missing' %}
    <div style="margin: 12px 12px; padding: 12px; background-color: #E3F2FD; border-left: 4px solid #42A5F5; border-radius: 4px;">
        <p style="margin: 0; color: #0D47A1; font-size: 12px;">
            <span style="font-weight: 700;">‚ÑπÔ∏è Note:</span> {{ t_params.baseline_note }}
        </p>
    </div>
    {% endif %}

    {% if baseline_and_thresholds.has_disabled_summary_baseline and not t_params.baseline_metric_warning %}
    <div style="margin: 12px 12px; padding: 12px; background-color: #E3F2FD; border-left: 4px solid #42A5F5; border-radius: 4px;">
        <p style="margin: 0; color: #0D47A1; font-size: 12px;">
            <span style="font-weight: 700;">‚ÑπÔ∏è Note:</span> Summary results baseline comparison is disabled. Enable "Summary results" in Quality Gate configuration to see baseline for general metrics.
        </p>
    </div>
    {% endif %}

    {% if baseline_and_thresholds.has_disabled_baseline and not t_params.baseline_metric_warning %}
    <div style="margin: 12px 12px; padding: 12px; background-color: #E3F2FD; border-left: 4px solid #42A5F5; border-radius: 4px;">
        <p style="margin: 0; color: #0D47A1; font-size: 12px;">
            <span style="font-weight: 700;">‚ÑπÔ∏è Note:</span> Per request baseline comparison is disabled. Enable "Per request results" in Quality Gate configuration to see baseline for individual requests.
        </p>
    </div>
    {% endif %}

    {% if t_params.baseline_info_warning %}
    <div style="margin: 12px 12px; padding: 12px; background-color: #E3F2FD; border-left: 4px solid #42A5F5; border-radius: 4px;">
        <p style="margin: 0; color: #0D47A1; font-size: 12px;">
            <span style="font-weight: 700;">‚ÑπÔ∏è Note:</span> {{ t_params.baseline_info_warning }}
        </p>
    </div>
    {% endif %}

    {% if t_params.baseline_disabled_metrics_info %}
    <div style="margin: 12px 12px; padding: 12px; background-color: #E3F2FD; border-left: 4px solid #42A5F5; border-radius: 4px;">
        <p style="margin: 0; color: #0D47A1; font-size: 12px;">
            <span style="font-weight: 700;">‚ÑπÔ∏è Note:</span> {{ t_params.baseline_disabled_metrics_info }}
        </p>
    </div>
    {% endif %}

    {% if t_params.sla_metric_warning %}
    <div style="margin: 12px 12px; padding: 12px; background-color: #E3F2FD; border-left: 4px solid #42A5F5; border-radius: 4px;">
        <p style="margin: 0; color: #0D47A1; font-size: 12px;">
            <span style="font-weight: 700;">‚ÑπÔ∏è Note:</span> {{ t_params.sla_metric_warning }}
        </p>
    </div>
    {% endif %}

    {% if t_params.sla_disabled_metrics_info %}
    <div style="margin: 12px 12px; padding: 12px; background-color: #E3F2FD; border-left: 4px solid #42A5F5; border-radius: 4px;">
        <p style="margin: 0; color: #0D47A1; font-size: 12px;">
            <span style="font-weight: 700;">‚ÑπÔ∏è Note:</span> {{ t_params.sla_disabled_metrics_info }}
        </p>
    </div>
    {% endif %}

    {% if t_params.sla_info_warning %}
    <div style="margin: 12px 12px; padding: 12px; background-color: #E3F2FD; border-left: 4px solid #42A5F5; border-radius: 4px;">
        <p style="margin: 0; color: #0D47A1; font-size: 12px;">
            <span style="font-weight: 700;">‚ÑπÔ∏è Note:</span> {{ t_params.sla_info_warning }}
        </p>
    </div>
    {% endif %}

    {% if t_params.sla_multiple_metrics_info %}
    <div style="margin: 12px 12px; padding: 12px; background-color: #E3F2FD; border-left: 4px solid #42A5F5; border-radius: 4px;">
        <p style="margin: 0; color: #0D47A1; font-size: 12px;">
            <span style="font-weight: 700;">‚ÑπÔ∏è Note:</span> {{ t_params.sla_multiple_metrics_info }}
        </p>
    </div>
    {% endif %}

    {% if baseline_and_thresholds.has_missing_sla and not baseline_and_thresholds.show_threshold_column and not t_params.sla_metric_warning and not t_params.sla_info_warning and t_params.summary_rt_check %}
    <div style="margin: 12px 12px; padding: 12px; background-color: #E3F2FD; border-left: 4px solid #42A5F5; border-radius: 4px;">
        <p style="margin: 0; color: #0D47A1; font-size: 12px;">
            <span style="font-weight: 700;">‚ÑπÔ∏è Note:</span> SLA thresholds are not configured for {{ general_metrics.comparison_metric }} metric. Configure SLA thresholds in Thresholds section to see threshold values and differences in Request metrics and General metrics tables.
        </p>
    </div>
    {% endif %}

</div>


</body>
</html>
